var proj = app.project;var renderCompName = "Name_Animation_Render";var workCompName = "Work_comp";var compItemSelect, renderItemSelect, searchItemSelect, nameCopyComp, playerNames;var namesList = [];var outlineItem, nameLong, nameMed, nameShort;var name, namePair, workingComp;var renderingComp, changedOutline;// create undo groupapp.beginUndoGroup("Text File Versioning");// step through all project items to find the comps we're interested in duplicating, and // assign them to variablesfor(var i = 1; i <= proj.numItems; i++){       switch(proj.item(i).name){        case renderCompName:            renderItemSelect = proj.item(i);            break;        case workCompName:            compItemSelect = proj.item(i);            break;        case "NAME_OUTLINE":            outlineItem = proj.item(i);            break;        case "Player Names":            playerNames = proj.item(i);            break;        case "Player Name_Long":            nameLong = proj.item(i);            break;        case "Player Name_Medium":            nameMed = proj.item(i);            break;        case "Player Name_Short":            nameShort = proj.item(i);    }  }// Prompt user to select text filevar myFile = File.openDialog("Please select input text file.");if(myFile != null){    // open file    var fileOK = myFile.open("r");        while(!myFile.eof){            name = myFile.readln();            namePair = name.split(", "); // the delimiter between First and Last names in the text file            namesList.push([namePair[0], namePair[1]]);    }        myFile.close();}// Make project folders to hold the versions and millions of precompsvar newFolder = proj.items.addFolder("Versions");var hidePrecomps = proj.items.addFolder("zz_DupPrecomps");// loop through the list of names "namesList"for(var i = 0; i< namesList.length; i++){    // duplicate the necessary comps and assign the objects to variables        renderingComp = renderItemSelect.duplicate();        workingComp = compItemSelect.duplicate();    changedOutline = outlineItem.duplicate();    nameCopyComp = playerNames.duplicate();    workingComp.parentFolder = hidePrecomps;    changedOutline.parentFolder = hidePrecomps;    nameCopyComp.parentFolder = hidePrecomps;       if (namesList[i][1].length < 5){        // duplicate nameShort as changedNameComp        changeNameComp = nameShort.duplicate();    }else if (namesList[i][1].length < 8) {        // duplicate nameMed as changedNameComp        changeNameComp = nameMed.duplicate();    }else{        //duplicate nameLong as changedNameComp        changeNameComp = nameLong.duplicate();    }    changeNameComp.parentFolder = hidePrecomps;        // put the duplicate comp in the "Versions" folder    renderingComp.parentFolder = newFolder;    // replace "Work_comp" with "Work_Comp 2" (like option_drag)    renderingComp.layer(workCompName).replaceSource(workingComp, true);    // replace "Player Names" with "Player Names 2"    workingComp.layer("Player Names").replaceSource(nameCopyComp, true);    // replace "Player Name_Long" with changeNameComp    nameCopyComp.layer("Player Name_Long").replaceSource(changeNameComp, true);    // replace "NAME_OUTLINE" with changedOutline    workingComp.layer("NAME_OUTLINE").replaceSource(changedOutline, true);    //Replace values in firstname and lastname layers    changeNameComp.layer("firstname").property("Source Text").setValue(namesList[i][0]);    changeNameComp.layer("lastname").property("Source Text").setValue(namesList[i][1]);    changedOutline.layer("lastname").property("Source Text").setValue(namesList[i][1]);        // rename comp to "lastname_firstname"    renderingComp.name = (namesList[i][1] + "_" + namesList[i][0]);    }app.endUndoGroup();