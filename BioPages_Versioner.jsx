// AE Project optimized by removing separate Long, Medium and Short name comps, and just // using layers firstname and lastname in the main Player Names comp. This eliminates// a lot of unnecessary comp duplicating, hopefully speeding up script preformance// and freeing some working memory.var proj = app.project;var renderCompName = "Bio_Fullscreen_EDIT_1";var workCompName = "REPLACE_PLAYER";var playerImage = "headshot";var compItemSelect, renderItemSelect, imageItem;var workingComp;var renderingComp;var boysFolder, girlsFolder;var boys = "Boys";var girls = "Girls";// create undo groupapp.beginUndoGroup("Text File Versioning");// step through all project items to find the comps we're interested in duplicating, and // assign them to variablesfor(var i = 1; i <= proj.numItems; i++){       switch(proj.item(i).name){        case renderCompName:            renderItemSelect = proj.item(i);            break;        case workCompName:            compItemSelect = proj.item(i);            break;        case playerImage:            imageItem = proj.item(i);            break;        case boys:            boysFolder = proj.item(i);            break;        case girls:            girlsFolder = proj.item(i)            break;    }  }// Here we load all the keyable targas into an array --------------------var headsArray = []// AE project item indexes start at 1for(var i = 1; i <= boysFolder.numItems; i++) {        for(var x = 1; x<= boysFolder.item(i).numItems; x++){                headsArray.push(boysFolder.item(i).item(x).item(1));         }}for(var i = 1; i <= girlsFolder.numItems; i++) {        for(var x = 1; x<= girlsFolder.item(i).numItems; x++){                headsArray.push(girlsFolder.item(i).item(x).item(1));        } }// -----------------------------------------------------------------------// Make project folders to hold the versions and millions of precompsvar newFolder = proj.items.addFolder("Versions");var headshotsAdjust = proj.items.addFolder("Adjust Positioning Here")    // duplicate the necessary comps and assign the objects to variables    // javascript arrays start at 0for(g=0; g<headsArray.length; g++){        renderingComp = renderItemSelect.duplicate();    workingComp = compItemSelect.duplicate();                // put the duplicate comp in the "Versions" folder    renderingComp.parentFolder = newFolder;        // put the master shots in the "Adjust positioning here" folder    workingComp.parentFolder = headshotsAdjust;    // replace "Headshot" with "Name_Headshot" (like option_drag)    renderingComp.layer(workCompName).replaceSource(workingComp, true);    // replace default image with specific version image from headsArray    workingComp.layer(playerImage).replaceSource(headsArray[g], true);        // This assumes the targa headshots are saved as "Last_First_xxxxx.tga"    // Gets just the "Last_First" part of that filename, using split()    var name = headsArray[g].name.split("_", 2);    // Then puts them back together again with join()    renderingComp.name = name.join("_")+"_BioBlast";    workingComp.name = name.join("_")+"_Headshot";}//------------------------------------------------------app.endUndoGroup();